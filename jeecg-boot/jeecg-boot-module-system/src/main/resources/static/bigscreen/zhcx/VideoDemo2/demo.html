<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="video-js-cdn.css">
<link rel="stylesheet" href="video.css">
<style>
p{
	text-align: justify;
	height: 20px;
	overflow: hidden;
}
p:after{
	display: inline-block;
	content:'';
	overflow: hidden;
	width: 100%;
	height: 0;
}
</style>
</head>
<body>

<video id="myVideo" style="width:100%;height:95%" class="video-js vjs-default-skin" controls preload="auto" autoplay="true"></video>

<script src="jquery-1.11.3.js"></script>
<script src="video.min.js"></script>
<script src="videojs-contrib-hls.js"></script>
<script>
/*
如何在浏览器观看视频
> 首先确定要观看视频的通道号。常用方式有两种
>
> a) 如果能访问视频云的管理界面，在`设备`页面通过`导出`按钮，得到通道列表。
>
> b) 通过  **基础服务->设备管理->获取设备树**  接口获得通道列表。
>
> c) 通过  **视频服务->实时监视->获取实时监视URI** 接口获得实时监视地址，送浏览器播放。

*/
videojs.options.flash.swf="./video-js.swf";
function GetQueryString(name){
    		var reg = new RegExp("(^|&)" + name +"=([^&]*)(&|$)");
    		var r = window.location.search.substr(1).match(reg);
    		if(r!=null){
    		return unescape(r[2]);
    		}else {
    		return null}
}
function playVideo(){
  var videoType = 'application/x-mpegURL';
  var type = GetQueryString("type");
  var channelid = GetQueryString("channelid");
  if ('FLV' == type) {
    videoType = 'video/x-flv';
  }
  $.ajax({
                url: "http://172.168.201.105:8080/jeecg-boot/interface/api/getVideoSource",
                async: true,
                type: "post",
                dataType: "json",
                data: {
                    channelId: channelid
                },
                success: function (record) {
                    var url_hls =record.result.hlsUrl;

					var myPlayer = videojs('myVideo',{
						bigPlayButton:false
					});
	
					myPlayer.src({
						type: videoType,
						src:url_hls
					});
                }, error: function () {
                   
                }
            });
  
	
}
playVideo();
</script>
</body>
</html>
