<!DOCTYPE html>
<html style="height: 100%;">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <title>项目投资</title>
    <style type="text/css">
        html,
        body {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
            overflow: hidden;
        }

        #data {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 90px;
        }

        #container {
            position: absolute;
            top: 90px;
            left: 0;
            right: 0;
            bottom: 0;
        }

        .datachild {
            width: 108px;
            height: 60px;
            background: rgb(18, 49, 116);
            margin-top: 15px;
            margin-left: 5px;
            border-radius: 5px;
            float: left;
            text-align: center;
            line-height: 30px;
            color: rgb(111, 192, 250);
        }
    </style>

    <script type="text/javascript" src="js/echarts.min.js"></script>
    <script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>

</head>

<body>
    <div id="data">
        <div id="data1" class="datachild">
            <span>计划总投资</span>
            <br />
            <span style="color: rgb(241, 140, 102); font-size: 26px; font-weight: bolder;"
                id="planInvestment">89.2亿</span>
        </div>
        <div id="data2" class="datachild">
            <span>实际投资</span>
            <br />
            <span style="color: rgb(225, 130, 255); font-size: 26px; font-weight: bolder;"
                id="actualInvestment">44.6亿</span>
        </div>
        <div id="data3" class="datachild">
            <span>投资进度</span>
            <br />
            <span style="color: rgb(98, 255, 164); font-size: 26px; font-weight: bolder;"
                id="investmentProgress">50%</span>
        </div>
    </div>
    <div id="container"></div>

    <script type="text/javascript">
        //地址参数
        function getQueryVariable(variable) {
            var query = window.location.search.substring(1);
            var vars = query.split("&");
            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split("=");
                if (pair[0] == variable) {
                    return pair[1];
                }
            }
            return (false);
        }

        var dom = document.getElementById("container");
        var myChart = echarts.init(dom);

        var id = getQueryVariable("id");
        var year = getQueryVariable("year");

        $.ajax({
            url: "http://172.168.201.105:8080/jeecg-boot/interface/api/getProjectInvestmentCensus",
            async: true,
            type: "post",
            dataType: "json",
            data: {
                id: id,
                year: year
            },
            success: function (record) {
                var result = record.result.investmentAnalysis;

                var planInvestment = record.result.planInvestment;
                var actualInvestment = record.result.actualInvestment;
                var investmentProgress = record.result.investmentProgress;

                $('#planInvestment').html(parseInt(planInvestment) + '亿');
                $('#actualInvestment').html(parseInt(actualInvestment) + '亿');
                $('#investmentProgress').html(parseInt(investmentProgress));

                var newlegend = new Array();
                var sdata1 = new Array();
                var sdata2 = new Array();
                var sdata3 = new Array();
                var sdata4 = new Array();
                for (var i = 0; i < result.length; i++) {
                    newlegend.push(result[i].QuarterName);
                    sdata1.push(parseInt(result[i].planInvestment));
                    sdata2.push(parseInt(result[i].actualInvestment));
                }



                option = {
                    tooltip: {
                        trigger: "axis",
                        axisPointer: {
                            // 坐标轴指示器，坐标轴触发有效
                            type: "shadow" // 默认为直线，可选为：'line' | 'shadow'
                        }
                    },
                    grid: {
                        top: '12%',
                        left: '15%',
                        right: '1%',
                        bottom: '15%'
                    },
                    legend: {
                        orient: 'horizontal',
                        itemWidth: 20,
                        itemGap: 2,
                        left: '5%',
                        top: '2%',
                        data: ['计划投资', '实际投资', '计划累计', '实际累计'],
                        textStyle: {
                            color: '#FFFFFF',
                        },
                    },
                    xAxis: [{
                        type: 'category',
                        boundaryGap: true,
                        axisLine: { //坐标轴轴线相关设置。数学上的x轴
                            show: true,
                            lineStyle: {
                                color: '#049df6'
                            },
                        },
                        axisLabel: { //坐标轴刻度标签的相关设置
                            textStyle: {
                                color: '#FFFFFF',
                                margin: 15,
                            },
                            rotate: 30
                        },
                        axisTick: {
                            show: false,
                        },
                        data: newlegend,
                    }],
                    yAxis: [{
                        name: '',
                        type: 'value',
                        min: 0,
                        splitNumber: 7,
                        splitLine: {
                            show: false,
                            lineStyle: {
                                color: '#e6e5e5'
                            }
                        },
                        axisLine: { //坐标轴轴线相关设置。数学上的x轴
                            show: true,
                            lineStyle: {
                                color: '#049df6'
                            },
                        },
                        axisLabel: {
                            textStyle: {
                                color: '#FFFFFF',
                                margin: 15,
                            },
                            formatter: function (value, index) {
                                return value.toFixed(1);
                            }
                        },
                        axisTick: {
                            show: false,
                        },
                    }],
                    series: [
                        {
                            name: '计划投资',
                            type: 'bar',
                            barWidth: 30,
                            barGap: '0%',
                            color: 'rgb(241, 140, 102)',
                            label: {
                                show: true,
                                position: 'insideTop',
                                textStyle: {
                                    color: '#F6F8FA',
                                }
                            },
                            itemStyle: {
                                normal: {
                                    barBorderRadius: 3,
                                }
                            },
                            data: sdata1
                        }, {
                            name: '实际投资',
                            type: 'bar',
                            barWidth: 30,
                            color: 'rgb(99, 232, 205)',
                            label: {
                                show: true,
                                position: 'insideTop',
                                textStyle: {
                                    color: '#A39B00',
                                }
                            },
                            itemStyle: {
                                normal: {
                                    barBorderRadius: 3,
                                }
                            },
                            data: sdata2
                        }, {
                            name: '计划累计',
                            type: 'line',
                            symbol: 'circle',
                            symbolSize: 10,
                            lineStyle: {
                                normal: {
                                    color: "rgb(241, 140, 102)",
                                },
                                borderColor: '#F3EB00'
                            },
                            itemStyle: {
                                normal: {
                                    color: "#FFFFFF",
                                }
                            },
                            data: sdata3
                        }, {
                            name: '实际累计',
                            type: 'line',
                            symbol: 'circle',
                            symbolSize: 10,
                            lineStyle: {
                                normal: {
                                    color: 'rgb(99, 232, 205)',
                                },
                                borderColor: '#F3EB00'
                            },
                            itemStyle: {
                                normal: {
                                    color: "#FFFFFF",
                                }
                            },
                            data: sdata4
                        },
                    ]
                };

                if (option && typeof option === "object") {
                    myChart.setOption(option, true);
                }

            }
        });


    </script>
</body>

</html>